<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tan: Packages</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">tan<span id="projectnumber">&#160;0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="concepts.html"><span>Concepts</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Packages </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Packages are a group of tan source files that share their public and private symbols. Each package is compiled into a single object file and then linked against libraries or other packages.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Creating a Package</h1>
<p>We can tell the compiler that a source file belongs to a package by adding a global statement:</p>
<div class="fragment"><div class="line">package &quot;&lt;package_name&gt;&quot;;</div>
</div><!-- fragment --><p>If this line doesn't exist, the file is treated as a separate package with the filename as the package name.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
File Structure for Packages</h1>
<div class="fragment"><div class="line">- my_package</div>
<div class="line">   - src1.tan</div>
<div class="line">   - src2.tan</div>
</div><!-- fragment --><p>And <code>src1.tan</code> and <code>src2.tan</code> should contain a <code>package "my_package";</code> statement. However, the compilation won't fail if this is not true, but the source file won't be treated as a part of that package.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Import Resolution</h1>
<p>Assuming we have a library called <code>dope</code> and a source file <code>sus.tan</code> wrote by someone else:</p>
<div class="fragment"><div class="line">- dope</div>
<div class="line">   - xx.tan</div>
<div class="line">   - xx.tan</div>
<div class="line">   - libdope.so</div>
<div class="line">- sus.tan</div>
</div><!-- fragment --><p>We can import <code>dope</code> by using the <code>import "dope"</code> and import <code>sus.tan</code> using <code>import "sus"</code>. When the compiler sees them, it will try to find the path to these source files, and import public symbols from them so that they can be used in our own code. During compilation, these files are not compiled. Instead, we link the object files generated from our code to <code>libdope.so</code> to produce whatever program we want.</p>
<p>The current implementation locate source files of an external package by:</p>
<ol type="1">
<li>using the absolute path to a file or folder if specified, otherwise:</li>
<li>searching for a directory or file with the same name as the package, with the following priorities:<ol type="a">
<li>Search in the same directory that contains the current source file</li>
<li>Search in user-defined include dirs</li>
<li>Search in system directories (for example, the compiler always know the location of <code>runtime</code> library)</li>
</ol>
</li>
<li>skipping candidates that don't contain has a <code>package</code> statement with the same package name</li>
</ol>
<p>Future plan includes configurable mapping between packages and their search paths.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Conventions</h1>
<p>Some soft rules (might change):</p>
<ul>
<li>As mentioned above, it's really convenient to make the package name and the folder name identical</li>
<li>Follow the same rules for variable names when deciding the package name </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
